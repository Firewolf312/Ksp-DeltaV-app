<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kerbal Delta-V Designer</title>
<style>
body{font-family:Arial;background:#0b0f1a;color:white;margin:0;padding:20px;overflow-x:hidden}
.container{max-width:1200px;margin:auto;background:#111827;padding:20px;border-radius:16px;box-shadow:0 0 40px #000}
h1{text-align:center}
.section{margin-bottom:20px}
select,input,button{padding:10px;border-radius:8px;border:none;margin:5px 0}
button{background:#2563eb;color:white;font-weight:bold;cursor:pointer}
button:hover{background:#1d4ed8}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.engine-card{background:#1f2937;padding:15px;border-radius:12px;text-align:center}
.result{margin-top:20px;font-size:18px}
.good{color:#22c55e}
.bad{color:#ef4444}
.progress{height:20px;background:#222;border-radius:10px;overflow:hidden;margin-top:10px}
.bar{height:100%;background:#22c55e}
.big-button{width:100%;font-size:18px;padding:14px;margin-top:10px}
.mode-toggle{display:flex;gap:10px;margin-top:10px}
.mode-toggle button{flex:1}
.hidden{display:none}
small{opacity:0.7}
.instructions{background:#141a2e;padding:15px;border-radius:12px;margin-bottom:15px}
</style>
</head>
<body>

<div class="container">
<h1>ðŸš€ Kerbal Delta-V Designer</h1>

<div class="instructions">
<h3>Instructions</h3>
<ul>
<li>Select your payload mass and mission profile to see the required Î”v.</li>
<li>You can choose Auto Design or Manual Design mode.</li>
<li>Multiple engines of the same type can be stacked on one stage (e.g., 4 Swivels on one plate).</li>
<li>In Sandbox mode, you can use any engine and tier freely for testing.</li>
<li>The output shows total Î”v, stage fuel, TWR, and estimated rocket height.</li>
<li>Auto Design now generates multiple viable variations automatically.</li>
</ul>
</div>

<div class="section">
<label><b>Rocket Tech Tier</b></label><br>
<select id="tierSelect" onchange="updateEngineLists()">
<option value="1">Tier 1 â€“ Early Career</option>
<option value="2">Tier 2 â€“ Mid Career</option>
<option value="3">Tier 3 â€“ Advanced</option>
<option value="4">Tier 4 â€“ Late Game / Nuclear</option>
<option value="99">Sandbox Mode â€“ All Engines</option>
</select>
</div>

<div class="section">
<label><b>Payload Mass (tons)</b></label><br>
<input type="number" id="payload" value="50" step="1">
</div>

<div class="section">
<label><b>Mission Profile</b></label><br>
<select id="mission" onchange="updateMissionDV()">
<option value="3400">Kerbin Orbit (LKO)</option>
<option value="4500">Mun Flyby</option>
<option value="5800">Mun Landing</option>
<option value="5400">Minmus Landing</option>
<option value="6200">Gilly Landing</option>
<option value="7000">Duna Orbit</option>
<option value="9000">Duna Landing</option>
<option value="8200">Eve Orbit</option>
<option value="12000">Eve Landing</option>
<option value="9500">Jool Orbit</option>
<option value="11000">Laythe Landing</option>
<option value="15000">Moho Orbit</option>
<option value="20000">Moho Landing</option>
<option value="6000">Solar Orbit Escape</option>
<option value="14000">Solar System Grand Tour</option>
</select>
<br>
<small id="missionDV">Required Î”v: 3400 m/s</small>
</div>

<div class="mode-toggle">
<button onclick="setMode('auto')">AUTO DESIGN</button>
<button onclick="setMode('manual')">MANUAL DESIGN</button>
</div>

<div id="autoSection">
<button class="big-button" onclick="autoDesignMultiple()">AUTO DESIGN MULTIPLE ROCKETS</button>
</div>

<div id="manualSection" class="hidden">
<div class="grid">
<div>
<label><b>Launch Engine</b></label><br>
<select id="manualLaunch"></select><br>
<label>Launch Fuel (tons)</label><br>
<input type="number" id="manualLaunchFuel" value="100">
<label>Number of Engines</label><br>
<input type="number" id="manualLaunchCount" value="1" min="1" max="10">
</div>
<div>
<label><b>Vacuum Engine</b></label><br>
<select id="manualVac"></select><br>
<label>Vacuum Fuel (tons)</label><br>
<input type="number" id="manualVacFuel" value="40">
<label>Number of Engines</label><br>
<input type="number" id="manualVacCount" value="1" min="1" max="10">
</div>
</div>
<button class="big-button" onclick="manualDesign()">CALCULATE MANUAL ROCKET</button>
</div>

<div class="grid" style="margin-top:20px">
<div class="engine-card" id="launchStage"></div>
<div class="engine-card" id="vacStage"></div>
</div>

<div class="result" id="output"></div>
<div class="progress"><div id="dvBar" class="bar" style="width:0%"></div></div>
<div style="position:fixed;bottom:10px;right:15px;opacity:0.4;font-size:12px;pointer-events:none;">Made by Black0ut</div>

</div>

<script>
const g=9.81;
const engines=[
{name:"Ant", isp:80, thrust:2, mass:0.02, tier:4},
{name:"Spider", isp:100, thrust:2, mass:0.02, tier:4},
{name:"Swivel", isp:320, thrust:215, mass:1.5, tier:1},
{name:"Terrier", isp:345, thrust:60, mass:0.5, tier:2},
{name:"Skipper", isp:320, thrust:650, mass:3, tier:2},
{name:"Mainsail", isp:310, thrust:1500, mass:6, tier:3},
{name:"Vector", isp:315, thrust:1000, mass:4, tier:3},
{name:"Rhino", isp:340, thrust:2000, mass:9, tier:3},
{name:"Mammoth", isp:315, thrust:4000, mass:15, tier:4},
{name:"Nerv", isp:800, thrust:60, mass:3, tier:4}
];
const manualLaunch=document.getElementById("manualLaunch");
const manualVac=document.getElementById("manualVac");
function getAvailableEngines(){
const selectedTier=parseInt(document.getElementById("tierSelect").value);
return selectedTier===99?engines:engines.filter(e=>e.tier<=selectedTier);
}
function updateEngineLists(){
manualLaunch.innerHTML="";
manualVac.innerHTML="";
getAvailableEngines().forEach(e=>{
let opt1=document.createElement("option"); opt1.value=engines.indexOf(e); opt1.textContent=e.name; manualLaunch.appendChild(opt1);
let opt2=document.createElement("option"); opt2.value=engines.indexOf(e); opt2.textContent=e.name; manualVac.appendChild(opt2);
});
}
updateEngineLists();
function setMode(mode){
document.getElementById("autoSection").classList.toggle("hidden",mode!="auto");
document.getElementById("manualSection").classList.toggle("hidden",mode!="manual");
}
function updateMissionDV(){
const missionSelect=document.getElementById("mission");
const selectedDV=missionSelect.value;
document.getElementById("missionDV").textContent="Required Î”v: "+selectedDV+" m/s";
}

// Auto design multiple variations
function autoDesignMultiple(){
const payload=parseFloat(document.getElementById("payload").value);
const requiredDV=parseFloat(document.getElementById("mission").value);
const available=getAvailableEngines();
let variations=[];
for(let i=0;i<5;i++){
let vacEngine=available[Math.floor(Math.random()*available.length)];
let launchEngine=available[Math.floor(Math.random()*available.length)];
let vacFuel=calculateFuel(vacEngine,payload,requiredDV*0.6);
let vacCount=Math.ceil(Math.random()*4);
let vacMass=payload+(vacEngine.mass*vacCount)+vacFuel;
let launchFuel=calculateFuel(launchEngine,vacMass,requiredDV*0.4);
let launchCount=Math.ceil(Math.random()*4);
variations.push({launchEngine,launchFuel,launchCount,vacEngine,vacFuel,vacCount});
}
// Display the first variation by default
renderRocket(payload,requiredDV,variations[0].launchEngine,variations[0].launchFuel,variations[0].vacEngine,variations[0].vacFuel,variations[0].launchCount,variations[0].vacCount);
// Add a selector for other variations
let output=document.getElementById("output");
let html='<br><b>Available Variations:</b><br>';
variations.forEach((v,i)=>{
html+=`<button onclick='renderRocket(${payload},${requiredDV},engines[${engines.indexOf(v.launchEngine)}],${v.launchFuel},engines[${engines.indexOf(v.vacEngine)}],${v.vacFuel},${v.launchCount},${v.vacCount})'>Variation ${i+1}</button>`;
});
output.innerHTML+=html;
}

function manualDesign(){
const payload=parseFloat(document.getElementById("payload").value);
const requiredDV=parseFloat(document.getElementById("mission").value);
let launchEngine=engines[manualLaunch.value];
let vacEngine=engines[manualVac.value];
let launchFuel=parseFloat(document.getElementById("manualLaunchFuel").value);
let vacFuel=parseFloat(document.getElementById("manualVacFuel").value);
let launchCount=parseInt(document.getElementById("manualLaunchCount").value);
let vacCount=parseInt(document.getElementById("manualVacCount").value);
renderRocket(payload,requiredDV,launchEngine,launchFuel,vacEngine,vacFuel,launchCount,vacCount);
}

function renderRocket(payload,requiredDV,launchEngine,launchFuel,vacEngine,vacFuel,launchCount,vacCount){
let vacMass=payload+(vacEngine.mass*vacCount)+vacFuel;
let totalMass=vacMass+(launchEngine.mass*launchCount)+launchFuel;
let vacDV=vacEngine.isp*g*Math.log((payload+(vacEngine.mass*vacCount)+vacFuel)/(payload+(vacEngine.mass*vacCount)));
let launchDV=launchEngine.isp*g*Math.log((totalMass)/(vacMass));
let totalDV=vacDV+launchDV;
let percent=Math.min((totalDV/requiredDV)*100,100);
document.getElementById("dvBar").style.width=percent+"%";
document.getElementById("dvBar").style.background=totalDV>=requiredDV?"#22c55e":"#ef4444";
let TWR=(launchEngine.thrust*launchCount*1000)/(totalMass*g);
let length=(launchFuel/8)+(vacFuel/8)+(launchEngine.mass*0.5*launchCount)+(vacEngine.mass*0.5*vacCount)+5;
let output="Total Î”v: "+totalDV.toFixed(0)+" / "+requiredDV+" m/s<br>Total Mass: "+totalMass.toFixed(1)+" t<br>Launch TWR: "+TWR.toFixed(2)+"<br>Estimated Rocket Height: "+length.toFixed(1)+" m<br><br>";
output+=(totalDV>=requiredDV && TWR>1.3)?"<span class='good'>âœ” Mission Capable</span>":"<span class='bad'>âš  Adjust Design</span>";
document.getElementById("output").innerHTML=output;
document.getElementById("launchStage").innerHTML=`<h3>Launch Stage</h3><p>Engine: ${launchEngine.name} x${launchCount}</p><p>Fuel: ${launchFuel.toFixed(1)} t</p><p>Î”v: ${launchDV.toFixed(0)} m/s</p>`;
document.getElementById("vacStage").innerHTML=`<h3>Vacuum Stage</h3><p>Engine: ${vacEngine.name} x${vacCount}</p><p>Fuel: ${vacFuel.toFixed(1)} t</p><p>Î”v: ${vacDV.toFixed(0)} m/s</p>`;
}

function calculateFuel(engine,payload,targetDV){
let dryMass=payload+engine.mass;
let fuel=0.5;
while(fuel<20000){
let fullMass=dryMass+fuel;
let dv=engine.isp*g*Math.log(fullMass/dryMass);
if(dv>=targetDV) return fuel;
fuel+=0.5;
}
return fuel;
}
updateMissionDV();
</script>

</body>
</html>
